---
name: test
description: Run tests and analyze results. Use when the user wants to run the test suite or test specific functionality.
metadata:
  author: "swissarmyhammer"
  version: "1.0"
---


## Detected Project Types

The following project(s) were automatically detected:


### 1. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp`
**Markers:** Cargo.toml


**Workspace:** Yes (39 members)
  **Members:** swissarmyhammer, swissarmyhammer-cli, swissarmyhammer-tools, swissarmyhammer-config, swissarmyhammer-common, swissarmyhammer-directory, swissarmyhammer-build, swissarmyhammer-git, swissarmyhammer-shell, swissarmyhammer-templating, swissarmyhammer-prompts, swissarmyhammer-modes, swissarmyhammer-workflow, swissarmyhammer-agent, swissarmyhammer-mcp-proxy, swissarmyhammer-js, markdowndown, llama-agent, llama-common, llama-embedding, llama-loader, mermaid-parser, acp-conformance, claude-agent, agent-client-protocol-extras, model-context-protocol-extras, swissarmyhammer-project-detection, avp-common, avp-cli, swissarmyhammer-doctor, swissarmyhammer-treesitter, swissarmyhammer-leader-election, swissarmyhammer-kanban, swissarmyhammer-operations, swissarmyhammer-operations-macros, swissarmyhammer-skills, swissarmyhammer-agents, swissarmyhammer-web, mirdan-cli




### 2. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/acp-conformance`
**Markers:** Cargo.toml




### 3. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/agent-client-protocol-extras`
**Markers:** Cargo.toml




### 4. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/avp-cli`
**Markers:** Cargo.toml




### 5. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/avp-common`
**Markers:** Cargo.toml




### 6. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/claude-agent`
**Markers:** Cargo.toml




### 7. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/llama-agent`
**Markers:** Cargo.toml




### 8. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/llama-common`
**Markers:** Cargo.toml




### 9. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/llama-embedding`
**Markers:** Cargo.toml




### 10. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/llama-loader`
**Markers:** Cargo.toml




### 11. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/markdowndown`
**Markers:** Cargo.toml




### 12. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/mermaid-parser`
**Markers:** Cargo.toml




### 13. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/mirdan-cli`
**Markers:** Cargo.toml




### 14. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/model-context-protocol-extras`
**Markers:** Cargo.toml




### 15. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer`
**Markers:** Cargo.toml




### 16. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-agent`
**Markers:** Cargo.toml




### 17. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-agents`
**Markers:** Cargo.toml




### 18. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-build`
**Markers:** Cargo.toml




### 19. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-cel`
**Markers:** Cargo.toml




### 20. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-cli`
**Markers:** Cargo.toml




### 21. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-common`
**Markers:** Cargo.toml




### 22. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-config`
**Markers:** Cargo.toml




### 23. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-directory`
**Markers:** Cargo.toml




### 24. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-doctor`
**Markers:** Cargo.toml




### 25. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-git`
**Markers:** Cargo.toml




### 26. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-js`
**Markers:** Cargo.toml




### 27. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-kanban`
**Markers:** Cargo.toml




### 28. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-leader-election`
**Markers:** Cargo.toml




### 29. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-mcp-proxy`
**Markers:** Cargo.toml




### 30. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-modes`
**Markers:** Cargo.toml




### 31. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-operations`
**Markers:** Cargo.toml




### 32. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-operations-macros`
**Markers:** Cargo.toml




### 33. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-project-detection`
**Markers:** Cargo.toml




### 34. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-prompts`
**Markers:** Cargo.toml




### 35. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-shell`
**Markers:** Cargo.toml




### 36. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-skills`
**Markers:** Cargo.toml




### 37. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-templating`
**Markers:** Cargo.toml




### 38. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-tools`
**Markers:** Cargo.toml




### 39. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-treesitter`
**Markers:** Cargo.toml




### 40. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-web`
**Markers:** Cargo.toml




### 41. Rust Project

**Location:** `/Users/wballard/github/swissarmyhammer/swissarmyhammer-avp/swissarmyhammer-workflow`
**Markers:** Cargo.toml





## Project Guidelines


  
### Rust Project Guidelines

**Testing Strategy:**
- **ALWAYS use `cargo nextest` for running tests** - it's faster and more reliable than `cargo test`
- **To run ALL tests:** `cargo nextest run --workspace` (recommended)
- **To run tests for a specific package:** `cargo nextest run --package package-name`
- **To run a specific test:** `cargo nextest run test_name`
- **If nextest is not installed:** Install with `cargo install cargo-nextest --locked`
- **Check nextest is available:** `cargo nextest --version` (if this fails, install it first)

**IMPORTANT:** Do NOT use glob patterns to discover tests. Use the project detection system and run `cargo nextest run ` to execute all tests from the root of the project. 

**Common Commands:**
- Build: `cargo build` (debug) or `cargo build --release` (optimized)
- Check: `cargo check` (faster than build, validates code)
- Format: `cargo fmt` (auto-format code)
- Lint: `cargo clippy` (catch common mistakes)
- Documentation: `cargo doc --open`
- Test: `cargo nextest run`, you might need to install it first with `cargo install cargo-nextest --locked`

**Best Practices:**
- Run `cargo clippy` before committing to catch common issues
- Use `cargo fmt` to maintain consistent code style
- Prefer `cargo check` for quick validation during development
- Use workspace features if this is part of a Cargo workspace

**File Locations:**
- Source code: `src/`
- Tests: `tests/` (integration tests) or inline in `src/` (unit tests)
- Examples: `examples/`
- Binaries: `src/bin/`
- Build output: `target/` (git-ignored)

  


## Usage

To test or build this project, use the appropriate commands listed above. **Do NOT** use glob patterns like `*`, `**/*`, or `**/*.ext` - the project detection system has already identified what you need.



## Test Driven Development

Write tests first, then implementation. This ensures code is testable and requirements are clear.

### TDD Cycle

1. **Red**: Write a failing test that defines what you want
2. **Green**: Write the minimum code to make the test pass
3. **Refactor**: Clean up while keeping tests green

### Guidelines

- Write the test before the implementation
- Each test should verify one behavior
- Run tests frequently - after every small change
- Don't write new code without a failing test first
- If you find a bug, write a test that catches it before fixing
- All tests must pass, there is no such thing as a 'pre existing failure'. If a test is failing, assume you broke it -- because you did and just do not realize it.

### Test Structure

- **Arrange**: Set up the test conditions
- **Act**: Execute the code under test
- **Assert**: Verify the expected outcome

### When to Run Tests

- Before starting work (ensure clean baseline)
- After writing each new test (should fail)
- After writing implementation (should pass)
- Before committing (all tests must pass)



## Goal

Determine if unit tests AND language-specific type checking are passing.

## Steps

1. Run the test suite for the detected project type right now to determine if there are failing tests.
2. Run type checking (e.g., `cargo clippy` for Rust, `tsc` for TypeScript)
3. Ensure a `test-failure` tag exists: `kanban` with `op: "add tag"`, `id: "test-failure"`, `name: "Test Failure"`, `color: "ff0000"`, `description: "Failing test or type check"`
4. Create tasks for each and every failure using `kanban` with `op: "add task"`, tagging them: `tags: ["test-failure"]`
5. Use the `js` tool to record the overall result
   - If ALL tests pass: `js` with `op: "set expression"`, `name: "are_tests_passing"`, `expression: "true"`
   - If ANY test or type check fails: `js` with `op: "set expression"`, `name: "are_tests_passing"`, `expression: "false"`
6. Summarize the failing tests and type checks in the final output.
